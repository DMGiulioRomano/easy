# =============================================================================
# ESEMPI YAML: Envelope su pitch_ratio, volume, pan
# =============================================================================

# =============================================================================
# ESEMPIO 1: Volume Fade (amplitude envelope)
# =============================================================================
# Svanisce da -6dB a -40dB in 4 secondi
composition:
  title: "il mondo dorme"

streams:
- stream_id: "fade_out"
  onset: 0.0
  duration: 4.0
  sample: "016.wav"
  grain:
    duration: 0.05
    envelope: hanning
  
  density: 50
  distribution: 0.5
  
  pointer:
    start: 0.0
    mode: linear
    speed: 1.0
  
  pitch:
    shift_semitones: 0
  
  output:
    volume: [[0, -6], [4, -40]]  # fade out lineare
    pan: 0.5


# =============================================================================
# ESEMPIO 2: Pan sweep (spatial motion)
# =============================================================================
# Si muove da sinistra (0.0) a destra (1.0) in 3 secondi
- stream_id: "pan_left_to_right"
  onset: 5.0
  duration: 3.0
  sample: "016.wav"
  
  grain:
    duration: 0.08
    envelope: hanning
  
  density: 30
  distribution: 0
  
  pointer:
    start: 0.5
    mode: linear
    speed: 1.0
  
  pitch:
    shift_semitones: 0
  
  output:
    volume: -12
    pan: [[0, 0.0], [3, 1.0]]  # left → right

# =============================================================================
# ESEMPIO 3: Glissando (pitch sweep)
# =============================================================================
# Glissando da 0 semitoni a +12 semitoni (un'ottava su) in 2 secondi
- stream_id: "glissando_up"
  onset: 9.0
  duration: 2.0
  sample: "016.wav"
  
  grain:
    duration: 0.03
    envelope: hanning
  
  density: 100
  distribution: 0  # sync per pitch più stabile
  
  pointer:
    start: 0.0
    mode: linear
    speed: 0.5  # time-stretch 2x
  
  pitch:
    shift_semitones: [[0, 0], [2, 12]]  # glissando lineare
  
  output:
    volume: -10
    pan: 0.5

# =============================================================================
# ESEMPIO 4: Combinazione complessa (cubic interpolation)
# =============================================================================
# Volume, pan E pitch che cambiano insieme con interpolazione cubica
- stream_id: "complex_motion"
  onset: 12.0
  duration: 5.0
  sample: "016.wav"
  
  grain:
    duration: 0.04
    envelope: hanning
  
  density: 80
  distribution: 0.3
  
  pointer:
    start: 0.2
    mode: linear
    speed: 1.0
  
  pitch:
    shift_semitones:
      type: cubic
      points: [[0, 0], [2, 7], [4, -5], [5, 0]]  # movimento pitch complesso
  
  output:
    volume:
      type: cubic
      points: [[0, -6], [2, -3], [4, -15], [5, -6]]  # crescendo → decrescendo
    pan:
      type: linear
      points: [[0, 0.2], [2.5, 0.8], [5, 0.5]]  # movimento spaziale

# =============================================================================
# ESEMPIO 5: Doppler effect (pitch + volume + pan)
# =============================================================================
# Simula un suono che passa da sinistra a destra con effetto Doppler
- stream_id: "doppler"
  onset: 18.0
  duration: 3.0
  sample: "016.wav"
  
  grain:
    duration: 0.02
    envelope: hanning
  
  density: 150
  distribution: 0
  
  pointer:
    start: 0.0
    mode: linear
    speed: 1.0
  
  pitch:
    shift_semitones:
      type: linear
      points: [[0, 3], [1.5, 0], [3, -3]]  # pitch alto → normale → basso
  
  output:
    volume:
      type: linear
      points: [[0, -20], [1.5, -6], [3, -20]]  # lontano → vicino → lontano
    pan:
      type: linear
      points: [[0, 0.0], [3, 1.0]]  # left → right

# =============================================================================
# ESEMPIO 6: Exponential decay (uso type: step per test)
# =============================================================================
# Volume con decay esponenziale simulato tramite step densi
- stream_id: "exp_decay"
  onset: 22.0
  duration: 4.0
  sample: "016.wav"
  
  grain:
    duration: 0.06
    envelope: hanning
  
  density: 40
  distribution: 0.2
  
  pointer:
    start: 0.0
    mode: linear
    speed: 1.0
  
  pitch:
    shift_semitones: 0
  
  output:
    # Simula decay esponenziale con step ravvicinati
    volume:
      type: step
      points: [[0, -3], [0.5, -6], [1, -10], [2, -18], [3, -28], [4, -40]]
    pan: 0.5

# =============================================================================
# ESEMPIO 7: Tremolo effect (volume oscillation)
# =============================================================================
# Tremolo simulato con volume che oscilla
- stream_id: "tremolo"
  onset: 27.0
  duration: 3.0
  sample: "016.wav"
  
  grain:
    duration: 0.05
    envelope: hanning
  
  density: 60
  distribution: 0
  
  pointer:
    start: 0.0
    mode: linear
    speed: 1.0
  
  pitch:
    shift_semitones: 0
  
  output:
    # Oscillazione volume (4 Hz circa)
    volume:
      type: linear
      points: [[0, -6], [0.25, -15], [0.5, -6], [0.75, -15], 
               [1.0, -6], [1.25, -15], [1.5, -6], [1.75, -15],
               [2.0, -6], [2.25, -15], [2.5, -6], [2.75, -15], [3.0, -6]]
    pan: 0.5

# =============================================================================
# ESEMPIO 8: Vibrato effect (pitch oscillation)
# =============================================================================
# Vibrato simulato con pitch che oscilla
- stream_id: "vibrato"
  onset: 31.0
  duration: 3.0
  sample: "016.wav"
  
  grain:
    duration: 0.03
    envelope: hanning
  
  density: 120
  distribution: 0  # sync per pitch stabile
  
  pointer:
    start: 0.0
    mode: linear
    speed: 1.0
  
  pitch:
    # Oscillazione pitch ±50 cents (5 Hz circa)
    shift_semitones:
      type: cubic  # cubic per smooth vibrato
      points: [[0, 0], [0.2, 0.5], [0.4, 0], [0.6, -0.5], [0.8, 0],
               [1.0, 0.5], [1.2, 0], [1.4, -0.5], [1.6, 0],
               [2.0, 0.5], [2.2, 0], [2.4, -0.5], [2.6, 0],
               [2.8, 0.5], [3.0, 0]]
  
  output:
    volume: -10
    pan: 0.5

# =============================================================================
# ESEMPIO 9: Backward compatible (valori fissi)
# =============================================================================
# Normale stream senza envelope (backward compatible)
- stream_id: "normal_fixed"
  onset: 35.0
  duration: 10.0
  sample: "016.wav"
  grain:
    duration: [[0,0.05],[3,.15],[6,0.07]]
    envelope: hanning  
  density: 50
  distribution: 0.3
  pointer:
    start: 0.0
    mode: linear
    speed: 1.0
  output:
    volume: -24  # numero fisso
    pan: 0.5     